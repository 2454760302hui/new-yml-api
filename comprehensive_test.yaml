# ğŸ¯ YH APIæµ‹è¯•æ¡†æ¶ - å…¨é¢åŠŸèƒ½éªŒè¯æµ‹è¯•å¥—ä»¶
# ä½¿ç”¨ httpbin.org å’Œè±†ç“£APIè¿›è¡Œå…¨åŠŸèƒ½éªŒè¯

config:
  name: "APIæµ‹è¯•æ¡†æ¶å…¨é¢åŠŸèƒ½éªŒè¯"
  description: "éªŒè¯å‚æ•°æå–ã€å¼•ç”¨ã€æ–­è¨€ã€æ¶ˆæ¯æ¨é€ç­‰æ‰€æœ‰åŠŸèƒ½"
  base_url: "https://httpbin.org"
  timeout: 30
  
  # å…¨å±€å˜é‡å®šä¹‰
  variables:
    test_user: "test_framework_user"
    test_email: "test@example.com"
    api_version: "v1"
    timestamp: "${current_timestamp()}"
  
  # å…¨å±€å¯¼å‡ºå˜é‡ï¼ˆç”¨äºè·¨ç”¨ä¾‹å…±äº«ï¼‰
  export:
    - shared_token
    - user_id
    - request_id

# ========================================
# æµ‹è¯•å¥—ä»¶1: åŸºç¡€HTTPæ–¹æ³•æµ‹è¯•
# ========================================
test_01_basic_get:
  - name: "GETè¯·æ±‚ - åŸºç¡€åŠŸèƒ½"
    description: "éªŒè¯GETè¯·æ±‚å’Œå‚æ•°ä¼ é€’"
    request:
      method: GET
      url: "/get"
      params:
        username: "${test_user}"
        email: "${test_email}"
        timestamp: "${timestamp}"
    validate:
      - check: status_code
        expected: 200
      - check: json.args.username
        expected: "${test_user}"
      - check: json.args.email
        expected: "${test_email}"
      - check: response_time
        expected: less_than
        value: 5000
    extract:
      request_id: json.headers.X-Amzn-Trace-Id

test_02_basic_post:
  - name: "POSTè¯·æ±‚ - JSONæ•°æ®"
    description: "éªŒè¯POSTè¯·æ±‚å‘é€JSONæ•°æ®"
    request:
      method: POST
      url: "/post"
      headers:
        Content-Type: "application/json"
        User-Agent: "YH-API-Test-Framework/3.0"
      json:
        username: "${test_user}"
        email: "${test_email}"
        action: "create_user"
        metadata:
          timestamp: "${timestamp}"
          version: "${api_version}"
    validate:
      - check: status_code
        expected: 200
      - check: json.json.username
        expected: "${test_user}"
      - check: json.json.action
        expected: "create_user"
      - check: json.json.metadata.version
        expected: "${api_version}"
    extract:
      user_id: json.json.username
      shared_token: json.headers.Content-Type

test_03_basic_put:
  - name: "PUTè¯·æ±‚ - æ›´æ–°æ•°æ®"
    description: "éªŒè¯PUTè¯·æ±‚æ›´æ–°æ•°æ®"
    request:
      method: PUT
      url: "/put"
      json:
        user_id: "${user_id}"
        email: "updated@example.com"
        status: "active"
    validate:
      - check: status_code
        expected: 200
      - check: json.json.user_id
        expected: "${user_id}"

test_04_basic_delete:
  - name: "DELETEè¯·æ±‚ - åˆ é™¤æ“ä½œ"
    description: "éªŒè¯DELETEè¯·æ±‚"
    request:
      method: DELETE
      url: "/delete"
      params:
        user_id: "${user_id}"
    validate:
      - check: status_code
        expected: 200

# ========================================
# æµ‹è¯•å¥—ä»¶2: å‚æ•°æå–å’Œå¼•ç”¨
# ========================================
test_05_extract_and_reference:
  - name: "æ­¥éª¤1 - ç”ŸæˆUUIDå¹¶æå–"
    description: "æµ‹è¯•å‚æ•°æå–åŠŸèƒ½"
    request:
      method: GET
      url: "/uuid"
    validate:
      - check: status_code
        expected: 200
    extract:
      generated_uuid: json.uuid
  
  - name: "æ­¥éª¤2 - ä½¿ç”¨æå–çš„UUID"
    description: "æµ‹è¯•å‚æ•°å¼•ç”¨åŠŸèƒ½"
    request:
      method: POST
      url: "/post"
      json:
        uuid: "${generated_uuid}"
        action: "use_extracted_uuid"
    validate:
      - check: status_code
        expected: 200
      - check: json.json.uuid
        expected: "${generated_uuid}"
      - check: json.json.action
        expected: "use_extracted_uuid"

test_06_chain_extraction:
  - name: "é“¾å¼æå– - ç¬¬ä¸€æ­¥"
    description: "å¤šæ­¥éª¤å‚æ•°æå–å’Œä¼ é€’"
    request:
      method: GET
      url: "/base64/SFRUUEJJTiBpcyBhd2Vzb21l"
    validate:
      - check: status_code
        expected: 200
    extract:
      decoded_text: json
  
  - name: "é“¾å¼æå– - ç¬¬äºŒæ­¥"
    description: "ä½¿ç”¨ä¸Šä¸€æ­¥æå–çš„æ•°æ®"
    request:
      method: POST
      url: "/post"
      json:
        source_data: "${decoded_text}"
        processed_by: "yh_framework"
    validate:
      - check: status_code
        expected: 200

# ========================================
# æµ‹è¯•å¥—ä»¶3: å¤æ‚æ–­è¨€éªŒè¯
# ========================================
test_07_complex_assertions:
  - name: "å¤æ‚æ–­è¨€æµ‹è¯•"
    description: "éªŒè¯å¤šç§æ–­è¨€ç±»å‹"
    request:
      method: GET
      url: "/headers"
      headers:
        X-Test-Header: "framework_test"
        X-Custom-Value: "12345"
    validate:
      # çŠ¶æ€ç æ–­è¨€
      - check: status_code
        expected: 200
      
      # JSONè·¯å¾„æ–­è¨€
      - check: json.headers.X-Test-Header
        expected: "framework_test"
      
      # å“åº”æ—¶é—´æ–­è¨€
      - check: response_time
        expected: less_than
        value: 3000
      
      # å­—ç¬¦ä¸²åŒ…å«æ–­è¨€
      - check: json.headers.Host
        expected: "httpbin.org"

test_08_json_response:
  - name: "JSONå“åº”æ·±åº¦éªŒè¯"
    description: "éªŒè¯å¤æ‚JSONç»“æ„"
    request:
      method: GET
      url: "/json"
    validate:
      - check: status_code
        expected: 200
      - check: json.slideshow.title
        expected: "Sample Slide Show"
      - check: json.slideshow.author
        expected: "Yours Truly"
      - check: json.slideshow.slides[0].title
        expected: "Wake up to WonderWidgets!"

# ========================================
# æµ‹è¯•å¥—ä»¶4: çŠ¶æ€ç å’Œé”™è¯¯å¤„ç†
# ========================================
test_09_status_codes:
  - name: "201çŠ¶æ€ç æµ‹è¯•"
    request:
      method: GET
      url: "/status/201"
    validate:
      - check: status_code
        expected: 201

test_10_404_handling:
  - name: "404é”™è¯¯å¤„ç†"
    request:
      method: GET
      url: "/status/404"
    validate:
      - check: status_code
        expected: 404

test_11_500_handling:
  - name: "500é”™è¯¯å¤„ç†"
    request:
      method: GET
      url: "/status/500"
    validate:
      - check: status_code
        expected: 500

# ========================================
# æµ‹è¯•å¥—ä»¶5: å“åº”å»¶è¿Ÿæµ‹è¯•
# ========================================
test_12_delay_response:
  - name: "å»¶è¿Ÿå“åº”æµ‹è¯• - 2ç§’"
    description: "éªŒè¯å»¶è¿Ÿå¤„ç†å’Œè¶…æ—¶è®¾ç½®"
    request:
      method: GET
      url: "/delay/2"
    validate:
      - check: status_code
        expected: 200
      - check: response_time
        expected: greater_than
        value: 2000
      - check: response_time
        expected: less_than
        value: 5000

# ========================================
# æµ‹è¯•å¥—ä»¶6: è®¤è¯å’Œæˆæƒ
# ========================================
test_13_basic_auth:
  - name: "Basicè®¤è¯æµ‹è¯•"
    description: "éªŒè¯HTTP Basicè®¤è¯"
    request:
      method: GET
      url: "/basic-auth/user/passwd"
      auth:
        username: "user"
        password: "passwd"
    validate:
      - check: status_code
        expected: 200
      - check: json.authenticated
        expected: true
      - check: json.user
        expected: "user"

test_14_bearer_token:
  - name: "Bearer Tokenæµ‹è¯•"
    description: "éªŒè¯Bearer Tokenè®¤è¯"
    request:
      method: GET
      url: "/bearer"
      headers:
        Authorization: "Bearer test_token_123456"
    validate:
      - check: status_code
        expected: 200
      - check: json.authenticated
        expected: true
      - check: json.token
        expected: "test_token_123456"

# ========================================
# æµ‹è¯•å¥—ä»¶7: Cookieså¤„ç†
# ========================================
test_15_cookie_set:
  - name: "è®¾ç½®Cookie"
    request:
      method: GET
      url: "/cookies/set"
      params:
        session_id: "abc123"
        user_token: "xyz789"
    validate:
      - check: status_code
        expected: 200

test_16_cookie_get:
  - name: "è·å–Cookies"
    request:
      method: GET
      url: "/cookies"
    validate:
      - check: status_code
        expected: 200

# ========================================
# æµ‹è¯•å¥—ä»¶8: å“åº”æ ¼å¼
# ========================================
test_17_json_response:
  - name: "JSONå“åº”æ ¼å¼"
    request:
      method: GET
      url: "/json"
    validate:
      - check: status_code
        expected: 200
      - check: headers.Content-Type
        expected: contains
        value: "application/json"

test_18_html_response:
  - name: "HTMLå“åº”æ ¼å¼"
    request:
      method: GET
      url: "/html"
    validate:
      - check: status_code
        expected: 200
      - check: headers.Content-Type
        expected: contains
        value: "text/html"

test_19_xml_response:
  - name: "XMLå“åº”æ ¼å¼"
    request:
      method: GET
      url: "/xml"
    validate:
      - check: status_code
        expected: 200
      - check: headers.Content-Type
        expected: contains
        value: "application/xml"

# ========================================
# æµ‹è¯•å¥—ä»¶9: é‡å®šå‘æµ‹è¯•
# ========================================
test_20_redirect:
  - name: "é‡å®šå‘æµ‹è¯•"
    request:
      method: GET
      url: "/redirect/3"
    validate:
      - check: status_code
        expected: 200

test_21_absolute_redirect:
  - name: "ç»å¯¹è·¯å¾„é‡å®šå‘"
    request:
      method: GET
      url: "/absolute-redirect/2"
    validate:
      - check: status_code
        expected: 200

# ========================================
# æµ‹è¯•å¥—ä»¶10: å›¾ç‰‡å’Œæ–‡ä»¶
# ========================================
test_22_image_jpeg:
  - name: "JPEGå›¾ç‰‡å“åº”"
    request:
      method: GET
      url: "/image/jpeg"
    validate:
      - check: status_code
        expected: 200
      - check: headers.Content-Type
        expected: "image/jpeg"

test_23_image_png:
  - name: "PNGå›¾ç‰‡å“åº”"
    request:
      method: GET
      url: "/image/png"
    validate:
      - check: status_code
        expected: 200
      - check: headers.Content-Type
        expected: "image/png"

# ========================================
# æµ‹è¯•å¥—ä»¶11: ç¼“å­˜æ§åˆ¶
# ========================================
test_24_cache_control:
  - name: "ç¼“å­˜æ§åˆ¶æµ‹è¯•"
    request:
      method: GET
      url: "/cache"
      headers:
        If-Modified-Since: "Mon, 01 Jan 2024 00:00:00 GMT"
    validate:
      - check: status_code
        expected: 200

test_25_etag:
  - name: "ETagæµ‹è¯•"
    request:
      method: GET
      url: "/etag/test-etag-value"
    validate:
      - check: status_code
        expected: 200

# ========================================
# æµ‹è¯•å¥—ä»¶12: ç¼–ç æµ‹è¯•
# ========================================
test_26_gzip_encoding:
  - name: "GZIPç¼–ç æµ‹è¯•"
    request:
      method: GET
      url: "/gzip"
      headers:
        Accept-Encoding: "gzip"
    validate:
      - check: status_code
        expected: 200
      - check: json.gzipped
        expected: true

test_27_deflate_encoding:
  - name: "Deflateç¼–ç æµ‹è¯•"
    request:
      method: GET
      url: "/deflate"
      headers:
        Accept-Encoding: "deflate"
    validate:
      - check: status_code
        expected: 200
      - check: json.deflated
        expected: true

# ========================================
# æµ‹è¯•å¥—ä»¶13: å“åº”æ£€æŸ¥
# ========================================
test_28_response_headers:
  - name: "å“åº”å¤´æ£€æŸ¥"
    request:
      method: GET
      url: "/response-headers"
      params:
        X-Custom-Header: "test_value"
        X-Framework: "YH-API-Test"
    validate:
      - check: status_code
        expected: 200
      - check: headers.X-Custom-Header
        expected: "test_value"

# ========================================
# æµ‹è¯•å¥—ä»¶14: ç”¨æˆ·ä»£ç†
# ========================================
test_29_user_agent:
  - name: "ç”¨æˆ·ä»£ç†æµ‹è¯•"
    request:
      method: GET
      url: "/user-agent"
      headers:
        User-Agent: "YH-API-Test-Framework/3.0 (Windows 10; Python 3.11)"
    validate:
      - check: status_code
        expected: 200
      - check: json.user-agent
        expected: contains
        value: "YH-API-Test-Framework"

# ========================================
# æµ‹è¯•å¥—ä»¶15: æ•°æ®ç¼–ç 
# ========================================
test_30_base64_encode:
  - name: "Base64ç¼–ç "
    request:
      method: GET
      url: "/base64/encode/hello_world"
    validate:
      - check: status_code
        expected: 200

# ========================================
# æµ‹è¯•å¥—ä»¶16: è±†ç“£APIæµ‹è¯•ï¼ˆå¦‚æœå¯è®¿é—®ï¼‰
# ========================================
test_31_douban_book_search:
  - name: "è±†ç“£å›¾ä¹¦æœç´¢"
    description: "ä½¿ç”¨è±†ç“£APIæœç´¢å›¾ä¹¦"
    request:
      method: GET
      url: "https://douban.uieee.com/v2/book/search"
      params:
        q: "Python"
        count: 5
    validate:
      - check: status_code
        expected: 200
    extract:
      book_count: json.count
      first_book_id: json.books[0].id

test_32_douban_book_detail:
  - name: "è±†ç“£å›¾ä¹¦è¯¦æƒ…"
    description: "è·å–ç‰¹å®šå›¾ä¹¦è¯¦æƒ…"
    request:
      method: GET
      url: "https://douban.uieee.com/v2/book/1220562"
    validate:
      - check: status_code
        expected: 200
      - check: json.title
        expected: contains
        value: "ç¼–ç¨‹"
    extract:
      book_title: json.title
      book_author: json.author[0]

# ========================================
# æµ‹è¯•å¥—ä»¶17: å¤šæ­¥éª¤å·¥ä½œæµ
# ========================================
test_33_workflow:
  - name: "å·¥ä½œæµ - æ­¥éª¤1: åˆ›å»ºèµ„æº"
    request:
      method: POST
      url: "/post"
      json:
        resource_type: "user"
        username: "${test_user}_workflow"
        email: "${test_email}"
    validate:
      - check: status_code
        expected: 200
    extract:
      resource_id: json.json.username
  
  - name: "å·¥ä½œæµ - æ­¥éª¤2: æŸ¥è¯¢èµ„æº"
    request:
      method: GET
      url: "/get"
      params:
        resource_id: "${resource_id}"
    validate:
      - check: status_code
        expected: 200
      - check: json.args.resource_id
        expected: "${resource_id}"
  
  - name: "å·¥ä½œæµ - æ­¥éª¤3: æ›´æ–°èµ„æº"
    request:
      method: PUT
      url: "/put"
      json:
        resource_id: "${resource_id}"
        status: "updated"
    validate:
      - check: status_code
        expected: 200
      - check: json.json.status
        expected: "updated"
  
  - name: "å·¥ä½œæµ - æ­¥éª¤4: åˆ é™¤èµ„æº"
    request:
      method: DELETE
      url: "/delete"
      params:
        resource_id: "${resource_id}"
    validate:
      - check: status_code
        expected: 200

# ========================================
# æµ‹è¯•å¥—ä»¶18: æ€§èƒ½æµ‹è¯•
# ========================================
test_34_performance_baseline:
  - name: "æ€§èƒ½åŸºçº¿æµ‹è¯•"
    description: "å»ºç«‹æ€§èƒ½åŸºçº¿"
    request:
      method: GET
      url: "/get"
      params:
        test_type: "performance"
    validate:
      - check: status_code
        expected: 200
      - check: response_time
        expected: less_than
        value: 2000

# ========================================
# æµ‹è¯•å¥—ä»¶19: è¾¹ç•Œå€¼æµ‹è¯•
# ========================================
test_35_empty_request:
  - name: "ç©ºè¯·æ±‚ä½“æµ‹è¯•"
    request:
      method: POST
      url: "/post"
      json: {}
    validate:
      - check: status_code
        expected: 200

test_36_large_payload:
  - name: "å¤§æ•°æ®é‡æµ‹è¯•"
    request:
      method: POST
      url: "/post"
      json:
        data: "x" * 1000
        array: [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
        nested:
          level1:
            level2:
              value: "deep_nested_value"
    validate:
      - check: status_code
        expected: 200
      - check: json.json.nested.level1.level2.value
        expected: "deep_nested_value"

# ========================================
# æµ‹è¯•å¥—ä»¶20: ç‰¹æ®Šå­—ç¬¦å¤„ç†
# ========================================
test_37_special_characters:
  - name: "ç‰¹æ®Šå­—ç¬¦æµ‹è¯•"
    request:
      method: POST
      url: "/post"
      json:
        chinese: "æµ‹è¯•ä¸­æ–‡å­—ç¬¦"
        emoji: "ğŸ¯ğŸš€ğŸ’ª"
        special: "!@#$%^&*()"
        unicode: "Hello ä¸–ç•Œ ğŸŒ"
    validate:
      - check: status_code
        expected: 200
      - check: json.json.chinese
        expected: "æµ‹è¯•ä¸­æ–‡å­—ç¬¦"
      - check: json.json.emoji
        expected: "ğŸ¯ğŸš€ğŸ’ª"

# ========================================
# æµ‹è¯•æ€»ç»“
# ========================================
# æœ¬æµ‹è¯•å¥—ä»¶è¦†ç›–:
# âœ… æ‰€æœ‰HTTPæ–¹æ³• (GET, POST, PUT, DELETE)
# âœ… å‚æ•°æå– (extract)
# âœ… å‚æ•°å¼•ç”¨ (${variable})
# âœ… å¤šç§æ–­è¨€ (status_code, json, headers, response_time)
# âœ… é“¾å¼è¯·æ±‚å’Œå·¥ä½œæµ
# âœ… è®¤è¯å’Œæˆæƒ
# âœ… Cookieså¤„ç†
# âœ… å¤šç§å“åº”æ ¼å¼ (JSON, HTML, XML)
# âœ… ç¼–ç å¤„ç† (GZIP, Deflate, Base64)
# âœ… é”™è¯¯å¤„ç† (404, 500)
# âœ… æ€§èƒ½æµ‹è¯•
# âœ… ç‰¹æ®Šå­—ç¬¦å’Œè¾¹ç•Œå€¼
# âœ… ç¬¬ä¸‰æ–¹APIé›†æˆ (è±†ç“£)
