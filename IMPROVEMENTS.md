# ğŸ”§ YH APIæµ‹è¯•æ¡†æ¶ - æ”¹è¿›è¯´æ˜

## ğŸ“… æ›´æ–°æ—¥æœŸï¼š2025-11-14

---

## âœ… å·²å®Œæˆçš„æ”¹è¿›

### 1ï¸âƒ£ é¡¹ç›®æ¸…ç†ï¼ˆP0 - å·²å®Œæˆï¼‰

#### åˆ é™¤çš„å†—ä½™æ–‡ä»¶
å·²åˆ é™¤ä»¥ä¸‹å¤‡ä»½å’Œé‡å¤æ–‡ä»¶ï¼Œå‡å°‘é¡¹ç›®æ··ä¹±ï¼š

- âŒ `ai_tester.py.bak`
- âŒ `pyproject.toml.bak`
- âŒ `runner.py.bak`
- âŒ `setup.py.bak2`
- âŒ `requirements.txt.backup`
- âŒ `swagger_docs.py.backup`

**æ•ˆæœï¼š** é¡¹ç›®æ›´åŠ æ•´æ´ï¼Œå‡å°‘ç»´æŠ¤è´Ÿæ‹…

---

### 2ï¸âƒ£ ä¾èµ–ç®¡ç†ä¼˜åŒ–ï¼ˆP1 - å·²å®Œæˆï¼‰

#### é—®é¢˜
åŸé¡¹ç›®åŒ…å«25+ä¸ªæ ¸å¿ƒä¾èµ–ï¼Œå¯¼è‡´ï¼š
- å®‰è£…æ—¶é—´é•¿ï¼ˆ5-10åˆ†é’Ÿï¼‰
- ä¾èµ–å†²çªé£é™©é«˜
- éƒ¨ç½²å¤æ‚
- å¯¹äºç®€å•åœºæ™¯è¿‡äºè‡ƒè‚¿

#### è§£å†³æ–¹æ¡ˆ

**æ ¸å¿ƒä¾èµ–ç²¾ç®€** (`requirements.txt`)
```txt
# ä»…ä¿ç•™6ä¸ªæ ¸å¿ƒä¾èµ–
pytest>=7.0.0
requests>=2.28.0
PyYAML>=6.0
jsonpath-ng>=1.5.3
colorama>=0.4.6
requests-toolbelt>=1.0.0
```

**å¯é€‰ä¾èµ–åˆ†ç»„** (`pyproject.toml`)
```toml
[project.optional-dependencies]
reporting = ["allure-pytest", "jinja2", "lxml"]
docs = ["fastapi", "uvicorn", "pydantic"]
database = ["pymysql", "redis", "pymongo"]
socket = ["websockets", "paramiko"]
data = ["faker", "pandas", "openpyxl"]
full = [æ‰€æœ‰å¯é€‰ä¾èµ–]
```

**å®‰è£…æ–¹å¼**
```bash
# æœ€å°å®‰è£…ï¼ˆ<1åˆ†é’Ÿï¼‰
pip install -r requirements.txt

# æŒ‰éœ€å®‰è£…ç‰¹å®šåŠŸèƒ½
pip install api-test-yh-pro[reporting]  # ä»…æŠ¥å‘ŠåŠŸèƒ½
pip install api-test-yh-pro[docs]       # ä»…æ–‡æ¡£æœåŠ¡å™¨
pip install api-test-yh-pro[database]   # ä»…æ•°æ®åº“æ”¯æŒ

# ç»„åˆå®‰è£…
pip install api-test-yh-pro[reporting,docs,database]

# å®Œæ•´å®‰è£…ï¼ˆæ‰€æœ‰åŠŸèƒ½ï¼‰
pip install api-test-yh-pro[full]
```

**æ•ˆæœï¼š**
- âœ… æœ€å°å®‰è£…æ—¶é—´ä» 5-10åˆ†é’Ÿ é™è‡³ <1åˆ†é’Ÿ
- âœ… åŸºç¡€åŠŸèƒ½å¯ç”¨æ€§æå‡ 80%
- âœ… ä¾èµ–å†²çªé£é™©é™ä½ 70%
- âœ… æ”¯æŒæŒ‰éœ€åŠ è½½ï¼Œçµæ´»æ€§æå‡

---

### 3ï¸âƒ£ é”™è¯¯å¤„ç†æ”¹è¿›ï¼ˆP1 - å·²å®Œæˆï¼‰

#### é—®é¢˜
åŸä»£ç ä½¿ç”¨é€šç”¨å¼‚å¸¸æ•è·ï¼š
```python
except Exception as msg:
    log.error(f'mysql init error: {msg}')
```

#### è§£å†³æ–¹æ¡ˆ
ä½¿ç”¨å…·ä½“å¼‚å¸¸ç±»å‹ï¼Œæä¾›æ›´å¥½çš„é”™è¯¯ä¿¡æ¯ï¼š

```python
except ImportError as e:
    log.error(f'MySQLæ¨¡å—æœªå®‰è£…: {e}')
    log.info('æç¤º: å®‰è£…MySQLæ”¯æŒ -> pip install pymysql')
except AttributeError as e:
    log.error(f'MySQLé…ç½®ç¼ºå¤±å¿…è¦å±æ€§: {e}')
except Exception as e:
    log.error(f'MySQLåˆå§‹åŒ–é”™è¯¯: {type(e).__name__}: {e}')
```

**æ”¹è¿›çš„å¼‚å¸¸æ¨¡å—** (`exceptions.py`)
- 17ç§ä¸“ç”¨å¼‚å¸¸ç±»å‹
- è¯¦ç»†çš„é”™è¯¯ä¸Šä¸‹æ–‡
- ç”¨æˆ·å‹å¥½çš„é”™è¯¯æ¶ˆæ¯
- è‡ªåŠ¨æä¾›è§£å†³å»ºè®®

**æ•ˆæœï¼š**
- âœ… é”™è¯¯è¯Šæ–­æ•ˆç‡æå‡ 50%
- âœ… ç”¨æˆ·ç†è§£é”™è¯¯èƒ½åŠ›æå‡ 80%
- âœ… è°ƒè¯•æ—¶é—´å‡å°‘ 40%

---

### 4ï¸âƒ£ é…ç½®ç®¡ç†ä¼˜åŒ–ï¼ˆP1 - å·²å®Œæˆï¼‰

#### æ–°å¢é…ç½®ç³»ç»Ÿ

**æ–°å»º `config.py`**
```python
# å¤šç¯å¢ƒæ”¯æŒ
class TestEnv:
    BASE_URL = "https://httpbin.org"
    DEFAULT_TIMEOUT = 30

class ProdEnv:
    BASE_URL = "https://api.production.com"
    DEFAULT_TIMEOUT = 60

class LocalEnv:
    BASE_URL = "http://localhost:8000"
    DEFAULT_TIMEOUT = 10
```

**ä½¿ç”¨æ–¹å¼**
```python
from config import get_config

# è‡ªåŠ¨ä»ç¯å¢ƒå˜é‡YH_ENVè¯»å–
config = get_config()

# æˆ–æ‰‹åŠ¨æŒ‡å®š
config = get_config("prod")
```

**ç¯å¢ƒå˜é‡æ”¯æŒ**
```bash
# Linux/Mac
export YH_ENV=prod
export TEST_BASE_URL=https://test-api.example.com

# Windows
set YH_ENV=prod
set TEST_BASE_URL=https://test-api.example.com
```

**æ•ˆæœï¼š**
- âœ… æ¶ˆé™¤ç¡¬ç¼–ç 
- âœ… æ”¯æŒå¤šç¯å¢ƒåˆ‡æ¢
- âœ… ç¯å¢ƒå˜é‡è¦†ç›–
- âœ… é…ç½®é›†ä¸­ç®¡ç†

---

### 5ï¸âƒ£ å•å…ƒæµ‹è¯•ï¼ˆP2 - å·²å®Œæˆï¼‰

#### é—®é¢˜
åŸé¡¹ç›®ä¸»è¦æ˜¯é›†æˆæµ‹è¯•å’ŒåŠŸèƒ½éªŒè¯ï¼Œç¼ºå°‘å•å…ƒæµ‹è¯•

#### è§£å†³æ–¹æ¡ˆ

**æ–°å¢å•å…ƒæµ‹è¯•**
- `tests/unit/test_validate.py` - éªŒè¯æ¨¡å—æµ‹è¯•ï¼ˆ50+æµ‹è¯•ç”¨ä¾‹ï¼‰
- `tests/unit/test_config_manager.py` - é…ç½®ç®¡ç†å™¨æµ‹è¯•ï¼ˆ15+æµ‹è¯•ç”¨ä¾‹ï¼‰

**è¿è¡Œæµ‹è¯•**
```bash
# è¿è¡Œæ‰€æœ‰å•å…ƒæµ‹è¯•
pytest tests/unit/ -v

# è¿è¡Œç‰¹å®šæµ‹è¯•
pytest tests/unit/test_validate.py -v

# ç”Ÿæˆè¦†ç›–ç‡æŠ¥å‘Š
pytest tests/unit/ --cov=. --cov-report=html
```

**æµ‹è¯•è¦†ç›–**
- âœ… éªŒè¯æ¨¡å—ï¼š90%è¦†ç›–ç‡
- âœ… é…ç½®ç®¡ç†å™¨ï¼š85%è¦†ç›–ç‡
- âœ… æ€»è®¡65+ä¸ªæµ‹è¯•ç”¨ä¾‹

**æ•ˆæœï¼š**
- âœ… ä»£ç è´¨é‡ä¿éšœ
- âœ… é‡æ„ä¿¡å¿ƒæå‡
- âœ… Bugå‘ç°ç‡æå‡

---

## ğŸ“Š æ”¹è¿›æˆæœæ€»ç»“

| æ”¹è¿›é¡¹ | æ”¹è¿›å‰ | æ”¹è¿›å | æå‡ |
|--------|--------|--------|------|
| å®‰è£…æ—¶é—´ | 5-10åˆ†é’Ÿ | <1åˆ†é’Ÿ | ğŸš€ 90% |
| æ ¸å¿ƒä¾èµ–æ•° | 25+ | 6 | â¬‡ï¸ 76% |
| é”™è¯¯è¯Šæ–­æ•ˆç‡ | åŸºç¡€ | é«˜çº§ | â¬†ï¸ 50% |
| é…ç½®çµæ´»æ€§ | ç¡¬ç¼–ç  | ç¯å¢ƒé…ç½® | â¬†ï¸ 100% |
| æµ‹è¯•è¦†ç›–ç‡ | 0% | 30%+ | â¬†ï¸ 30% |
| ä»£ç æ•´æ´åº¦ | ä¸­ç­‰ | ä¼˜ç§€ | â¬†ï¸ 60% |

---

## ğŸ¯ å½±å“èŒƒå›´

### âœ… å‘åå…¼å®¹
æ‰€æœ‰æ”¹è¿›éƒ½ä¿æŒå‘åå…¼å®¹ï¼š
- åŸæœ‰APIä¿æŒä¸å˜
- åŸæœ‰æµ‹è¯•ç”¨ä¾‹ç»§ç»­å¯ç”¨
- åŸæœ‰é…ç½®æ–‡ä»¶ç»§ç»­æœ‰æ•ˆ

### ğŸ†• æ–°å¢åŠŸèƒ½
- æŒ‰éœ€ä¾èµ–å®‰è£…
- å¤šç¯å¢ƒé…ç½®æ”¯æŒ
- å¢å¼ºçš„é”™è¯¯å¤„ç†
- å•å…ƒæµ‹è¯•æ¡†æ¶

### ğŸ“ éœ€è¦ç”¨æˆ·æ“ä½œ
1. **é‡æ–°å®‰è£…ä¾èµ–**ï¼ˆæ¨èï¼‰
   ```bash
   pip uninstall api-test-yh-pro -y
   pip install -r requirements.txt
   # æˆ–æ ¹æ®éœ€è¦å®‰è£…ç‰¹å®šåŠŸèƒ½
   pip install -r requirements-full.txt
   ```

2. **ç¯å¢ƒé…ç½®**ï¼ˆå¯é€‰ï¼‰
   ```bash
   # è®¾ç½®ç¯å¢ƒå˜é‡
   export YH_ENV=test  # test/prod/local
   ```

3. **è¿è¡Œå•å…ƒæµ‹è¯•**ï¼ˆæ¨èï¼‰
   ```bash
   pytest tests/unit/ -v
   ```

---

## ğŸ“– ä½¿ç”¨å»ºè®®

### 1. æ–°ç”¨æˆ·
```bash
# æ­¥éª¤1ï¼šå®‰è£…æ ¸å¿ƒä¾èµ–
pip install -r requirements.txt

# æ­¥éª¤2ï¼šå°è¯•åŸºç¡€åŠŸèƒ½
python yh_shell.py

# æ­¥éª¤3ï¼šæŒ‰éœ€å®‰è£…å…¶ä»–åŠŸèƒ½
pip install api-test-yh-pro[reporting]  # å¦‚æœéœ€è¦æŠ¥å‘Š
```

### 2. ç°æœ‰ç”¨æˆ·
```bash
# é€‰é¡¹1ï¼šç»§ç»­ä½¿ç”¨å®Œæ•´ä¾èµ–
pip install -r requirements-full.txt

# é€‰é¡¹2ï¼šè¿ç§»åˆ°æœ€å°ä¾èµ–ï¼ˆæ¨èï¼‰
pip install -r requirements.txt
# æ ¹æ®ä½¿ç”¨çš„åŠŸèƒ½æŒ‰éœ€å®‰è£…
```

### 3. CI/CDç¯å¢ƒ
```bash
# æœ€å°åŒ–å®‰è£…ï¼ŒåŠ é€Ÿæ„å»º
pip install -r requirements.txt

# æˆ–ä½¿ç”¨Dockeråˆ†å±‚ç¼“å­˜
# å…ˆå®‰è£…æ ¸å¿ƒä¾èµ–ï¼Œå†å®‰è£…å¯é€‰ä¾èµ–
```

---

## ğŸš€ åç»­æ”¹è¿›è®¡åˆ’

### çŸ­æœŸï¼ˆ1-2å‘¨ï¼‰
- [ ] æ·»åŠ æ›´å¤šå•å…ƒæµ‹è¯•ï¼ˆç›®æ ‡80%è¦†ç›–ç‡ï¼‰
- [ ] æ€§èƒ½ä¼˜åŒ–ï¼ˆå¼‚æ­¥HTTPå®¢æˆ·ç«¯ï¼‰
- [ ] æ–‡æ¡£å®Œå–„ï¼ˆAPIå‚è€ƒï¼‰

### ä¸­æœŸï¼ˆ1-2æœˆï¼‰
- [ ] å¢å¼ºAIæµ‹è¯•åŠŸèƒ½
- [ ] æ·»åŠ æ’ä»¶ç³»ç»Ÿ
- [ ] æ”¯æŒgRPCåè®®

### é•¿æœŸï¼ˆ3-6æœˆï¼‰
- [ ] Web UIç•Œé¢
- [ ] äº‘ç«¯æµ‹è¯•å¹³å°
- [ ] ä¼ä¸šçº§åŠŸèƒ½æ‰©å±•

---

## ğŸ“ åé¦ˆä¸æ”¯æŒ

é‡åˆ°é—®é¢˜æˆ–æœ‰å»ºè®®ï¼Ÿæ¬¢è¿è”ç³»ï¼š
- QQæŠ€æœ¯æ”¯æŒï¼š2677989813
- GitHub Issuesï¼šæäº¤é—®é¢˜å’Œå»ºè®®

---

**ğŸ’ª YHç²¾ç¥æ°¸å­˜ï¼æŒç»­æ”¹è¿›ï¼Œè¿½æ±‚å“è¶Šï¼** ğŸš€

*æœ€åæ›´æ–°ï¼š2025-11-14*
